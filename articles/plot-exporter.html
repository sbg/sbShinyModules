<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Plot Exporter Module: Integration and Examples • sbShinyModules</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot Exporter Module: Integration and Examples">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sbShinyModules</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/file-pickers.html">File Picker Module: Integration and Examples</a></li>
    <li><a class="dropdown-item" href="../articles/generic-file-exporter.html">Generic File Exporter Module: Integration and Examples</a></li>
    <li><a class="dropdown-item" href="../articles/load-files-and-metadata.html">Utility Function get_all_project_files(): Integration and Examples</a></li>
    <li><a class="dropdown-item" href="../articles/plot-exporter.html">Plot Exporter Module: Integration and Examples</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plot Exporter Module: Integration and Examples</h1>
            
            <h4 data-toc-skip class="date">2024-09-16</h4>
      

      <div class="d-none name"><code>plot-exporter.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="module-overview">Module Overview<a class="anchor" aria-label="anchor" href="#module-overview"></a>
</h2>
<p>The Plot Exporter Module enables users to save and export plots
generated within a Shiny app to the Seven Bridges Platform. This module
provides a user-friendly interface for exporting plots in various
formats and integrates seamlessly with the server-side logic of your
Shiny app.</p>
<div class="section level3">
<h3 id="ui-function">UI Function<a class="anchor" aria-label="anchor" href="#ui-function"></a>
</h3>
<p>The UI function for the Plot Exporter Module creates an action button
that triggers a modal dialog for exporting plots. This modal dialog
includes settings for selecting output formats and managing export
options.</p>
<p><strong>Parameters</strong>:</p>
<ul>
<li><p><strong>id</strong>: A unique identifier for the module
instance.</p></li>
<li><p><strong>save_button_title</strong>: The label for the button that
triggers the export modal.</p></li>
</ul>
<div class="section level4">
<h4 id="ui-function-call">UI Function Call<a class="anchor" aria-label="anchor" href="#ui-function-call"></a>
</h4>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mod_plot_exporter_ui</span><span class="op">(</span><span class="st">"plot_exporter_1"</span>, save_button_title <span class="op">=</span> <span class="st">"Save Plot"</span><span class="op">)</span></span></code></pre></div>
<br><center>
<div class="float">
<img src="figures/plot_exporter/save_plot_button.png" alt="Plot exporter button"><div class="figcaption">Plot exporter button</div>
</div>
</center>
<p><br></p>
</div>
</div>
<div class="section level3">
<h3 id="server-function">Server Function<a class="anchor" aria-label="anchor" href="#server-function"></a>
</h3>
<p>The server function handles the logic for exporting plots. It
integrates with reactiveValues to manage the plot object and provides
settings for output formats and directory paths. This function is
crucial for enabling users to export plots in various formats and save
them to the Seven Bridges Platform.</p>
<p><strong>Parameters</strong>:</p>
<ul>
<li><p><strong>id</strong>: Module’s ID.</p></li>
<li><p><strong>plot_reactVals</strong>: A reactiveValues object
containing a plot slot with the plot object created using recordPlot().
This is the plot which will be exported.</p></li>
<li><p><strong>output_formats</strong>: The supported output formats for
exporting the plot. Options include “png”, “pdf”, “svg”, “jpeg”, “bmp”,
and “tiff”.</p></li>
<li><p><strong>module_title</strong>: The title displayed in the modal
dialog top-left corner.</p></li>
<li><p><strong>sbg_directory_path</strong>: Path to the mounted
/sbgenomics directory, which should include project-files, output-files,
and workspace sub-directories. This directory structure must exist on
the instance where the app runs. For local testing, create a mock
directory with the same structure and populate it with test
files.</p></li>
<li><p><strong>btns_div_width</strong>: Width of the div() containing
the buttons for saving plots in the modal dialog. Default is
12.</p></li>
</ul>
<div class="section level4">
<h4 id="server-function-call">Server Function Call<a class="anchor" aria-label="anchor" href="#server-function-call"></a>
</h4>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mod_plot_exporter_server</span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="st">"plot_exporter_1"</span>,</span>
<span>  plot_reactVals <span class="op">=</span> <span class="va">helper_reactive</span>,</span>
<span>  output_formats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"png"</span>, <span class="st">"pdf"</span><span class="op">)</span>,</span>
<span>  module_title <span class="op">=</span> <span class="st">"Export Plot"</span>,</span>
<span>  sbg_directory_path <span class="op">=</span> <span class="st">"/sbgenomics"</span>,</span>
<span>  btns_div_width <span class="op">=</span> <span class="fl">12</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><strong>Note</strong>: If you are developing a Shiny application that
will be hosted on-demand on the Seven Bridges Platform, the
sbg_directory_path parameter should be set to the default value of
<code>/sbgenomics</code>. This path points to the /sbgenomics directory,
which already includes the project-files, output-files, and workspace
sub-directories. For local testing of your application, you can create a
mock sbgenomics directory with the same structure—containing
project-files, output-files, and workspace sub-directories. Populate
this mock directory with test files that replicate the project file
structure on the Platform.</p>
<br><center>
<div class="float">
<img src="figures/plot_exporter/save_plot_modal_dialog.png" alt="Plot exporter modal dialog"><div class="figcaption">Plot exporter modal dialog</div>
</div>
</center>
<p><br></p>
</div>
</div>
<div class="section level3">
<h3 id="plot-exporter-module-modal-dialog-features">Plot Exporter Module: Modal Dialog Features<a class="anchor" aria-label="anchor" href="#plot-exporter-module-modal-dialog-features"></a>
</h3>
<p>When users click the Save Plot button, a modal dialog appears,
offering several advanced features for customizing and exporting the
plot.</p>
<p>The modal dialog provides two options for resizing the plot before
saving:</p>
<div class="section level4">
<h4 id="plot-resizing">Plot Resizing<a class="anchor" aria-label="anchor" href="#plot-resizing"></a>
</h4>
<p>The modal dialog provides two options for resizing the plot before
saving:</p>
<ul>
<li><p><strong>Interactive Resizing</strong>: Users can drag and resize
the plot box using a cursor. This functionality leverages the React
Moveable library, allowing users to adjust the plot dimensions directly.
As users resize the box, the plot within it automatically adjusts to fit
the new size, and the modal dialog resizes accordingly to accommodate
the updated plot dimensions.</p></li>
<li><p><strong>Manual Resizing</strong>: Users can also specify the plot
width and height manually. By entering the desired dimensions and
clicking the “Update Preview” button, the plot and modal dialog will
adjust to reflect the new size. This option provides precise control
over the plot appearance.</p></li>
</ul>
<center>
<div class="float">
<img src="figures/plot_exporter/plot_resizing.png" alt="Plot resizing feature"><div class="figcaption">Plot resizing feature</div>
</div>
</center>
<p><br></p>
</div>
<div class="section level4">
<h4 id="file-naming-and-valdation">File Naming and Valdation<a class="anchor" aria-label="anchor" href="#file-naming-and-valdation"></a>
</h4>
<p>The modal dialog includes a text input element where users can set
the name (base name) for the plot file. Key aspects of this feature
include:</p>
<ul>
<li>
<strong>File Name Validation</strong>: The module performs real-time
validation to check if a file with the same name (base name + extension)
already exists in the project directory or if it is previously saved
within the same session (stored in the output-files). If a conflict is
detected, a warning message is displayed near the text input field,
prompting users to choose a different name.</li>
</ul>
<center>
<div class="float">
<img src="figures/plot_exporter/plot_filename_validation.png" alt="Plot name validation"><div class="figcaption">Plot name validation</div>
</div>
</center>
<p><br></p>
<ul>
<li>
<strong>Overwrite Option</strong>: For cases where users prefer to
overwrite an existing file, an overwrite switch is available. This
option allows users to save the plot with the same name, regardless of
existing files in the project directory.</li>
</ul>
<center>
<div class="float">
<img src="figures/plot_exporter/plot_filename_overwrite.png" alt="Overwrite filename"><div class="figcaption">Overwrite filename</div>
</div>
</center>
<p><br></p>
</div>
<div class="section level4">
<h4 id="file-format-selection">File Format Selection<a class="anchor" aria-label="anchor" href="#file-format-selection"></a>
</h4>
<p>At the bottom of the modal dialog, users can choose from various file
formats for exporting the plot. This section includes:</p>
<ul>
<li>
<strong>Format Buttons</strong>: The dialog features buttons for the
default file formats: PNG, PDF, SVG, JPEG, BMP, and TIFF. The specific
formats available are controlled by the output_formats parameter in the
mod_plot_exporter_server() function. By default, all six formats are
shown, but you can limit the options to a subset of these formats.</li>
</ul>
<center>
<div class="float">
<img src="figures/plot_exporter/plot_format_selection.png" alt="File format selection buttons"><div class="figcaption">File format selection buttons</div>
</div>
</center>
<p><br></p>
<ul>
<li>
<strong>Saving the Plot</strong>: Clicking a format button triggers
the plot export process, using the specified base name and the selected
file extension. This action also invokes the file name validation
mechanism described above, ensuring that users are alerted to any
potential conflicts before saving.</li>
</ul>
<p><strong>Please Note</strong>: By default, plot files are saved in the
<code>/sbgenomics/output-files</code> directory. Once the Shiny app is
stopped, these files will be accessible from the “Files” tab of the
project from which the app was launched.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="example-file-picker-module-in-action">Example: File Picker Module in Action<a class="anchor" aria-label="anchor" href="#example-file-picker-module-in-action"></a>
</h2>
<p>The following Shiny app demonstrates the usage of the Plot Exporter
module.</p>
<p>Keep in mind that the UI function only creates the button for
triggering the export, and the server function handles the export
settings and file saving.</p>
<p><strong>Note:</strong> To run this example on your computer, please
ensure you have the <strong>sbShinyModules</strong> package
installed.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://shiny.posit.co/" class="external-link">shiny</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">sbShinyModules</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># App's  UI</span></span>
<span><span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html" class="external-link">fluidPage</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/titlePanel.html" class="external-link">titlePanel</a></span><span class="op">(</span><span class="st">"Save plots for export to Platform - Module Demo"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/sidebarLayout.html" class="external-link">sidebarLayout</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/sidebarLayout.html" class="external-link">sidebarPanel</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/sliderInput.html" class="external-link">sliderInput</a></span><span class="op">(</span><span class="st">"bins"</span>,</span>
<span>        <span class="st">"Number of bins:"</span>,</span>
<span>        min <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        max <span class="op">=</span> <span class="fl">50</span>,</span>
<span>        value <span class="op">=</span> <span class="fl">30</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/sidebarLayout.html" class="external-link">mainPanel</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/plotOutput.html" class="external-link">plotOutput</a></span><span class="op">(</span><span class="st">"distPlot"</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html" class="external-link">fluidRow</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html" class="external-link">h3</a></span><span class="op">(</span><span class="st">"Export Plot to Platform"</span><span class="op">)</span>,</span>
<span>        <span class="fu"><a href="https://rstudio.github.io/htmltools/reference/builder.html" class="external-link">br</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        <span class="fu">sbShinyModules</span><span class="fu">::</span><span class="fu"><a href="../reference/mod_save_plot_to_export_ui.html">mod_save_plot_to_export_ui</a></span><span class="op">(</span></span>
<span>          id <span class="op">=</span> <span class="st">"plot_exporter"</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># App's Server Logic</span></span>
<span><span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Create reactive values list with plot field</span></span>
<span>  <span class="va">helper_reactive</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactiveValues.html" class="external-link">reactiveValues</a></span><span class="op">(</span></span>
<span>    plot <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="va">plot_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/observeEvent.html" class="external-link">eventReactive</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">bins</span>, <span class="op">{</span></span>
<span>    <span class="va">bins</span> <span class="op">&lt;-</span> <span class="va">input</span><span class="op">$</span><span class="va">bins</span> <span class="op">+</span> <span class="fl">1</span></span>
<span></span>
<span>    <span class="co"># Draw the histogram with the specified number of bins</span></span>
<span>    <span class="va">faithful</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span></span>
<span>        breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>,</span>
<span>          length.out <span class="op">=</span> <span class="va">bins</span></span>
<span>        <span class="op">)</span>,</span>
<span>        col <span class="op">=</span> <span class="st">"darkgray"</span>,</span>
<span>        border <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>        main <span class="op">=</span> <span class="st">"Geyser eruption duration"</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="va">helper_reactive</span><span class="op">$</span><span class="va">plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/recordplot.html" class="external-link">recordPlot</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">output</span><span class="op">$</span><span class="va">distPlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderPlot.html" class="external-link">renderPlot</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="fu">plot_output</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Call the plot exporter module</span></span>
<span>  <span class="fu">sbShinyModules</span><span class="fu">::</span><span class="fu"><a href="../reference/mod_save_plot_to_export_server.html">mod_save_plot_to_export_server</a></span><span class="op">(</span></span>
<span>    id <span class="op">=</span> <span class="st">"plot_exporter"</span>,</span>
<span>    plot_reactVals <span class="op">=</span> <span class="va">helper_reactive</span>,</span>
<span>    module_title <span class="op">=</span> <span class="st">"Save plot to Platform"</span>,</span>
<span>    sbg_directory_path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>      <span class="st">"tests"</span>, <span class="st">"testthat"</span>, <span class="st">"sbgenomics_test"</span>,</span>
<span>      package <span class="op">=</span> <span class="st">"sbShinyModules"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    btns_div_width <span class="op">=</span> <span class="fl">12</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Run the Shiny app</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html" class="external-link">shinyApp</a></span><span class="op">(</span><span class="va">ui</span>, <span class="va">server</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Marko Trifunovic, Marija Gacic, Velsera.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
